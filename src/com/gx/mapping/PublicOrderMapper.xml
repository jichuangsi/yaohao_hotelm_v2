<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gx.dao.PublicOrderDao" >
  <resultMap id="BaseResultMap" type="com.gx.po.PublicOrderPo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Oct 16 19:18:30 CST 2016.
    -->
    <constructor >
      <idArg column="id" jdbcType="INTEGER" javaType="java.lang.Integer" />
      <arg column="orderNumber" jdbcType="VARCHAR" javaType="java.lang.String" />
      <arg column="hotelm" jdbcType="INTEGER" javaType="java.lang.String" />
      <arg column="roomNuber" jdbcType="INTEGER" javaType="java.lang.String" />
      <arg column="supplier" jdbcType="VARCHAR" javaType="java.lang.String" />
      <arg column="pname" jdbcType="INTEGER" javaType="java.lang.String" />
      <arg column="sex" jdbcType="VARCHAR" javaType="java.lang.String" />
      <arg column="phone" jdbcType="VARCHAR" javaType="java.lang.String" />
      <arg column="checkinTime" jdbcType="TIMESTAMP" javaType="java.sql.Timestamp" />
      <arg column="checkoutTime" jdbcType="TIMESTAMP" javaType="java.sql.Timestamp" />
      <arg column="money" jdbcType="DOUBLE" javaType="java.lang.Double" />
      <arg column="currency" jdbcType="INTEGER" javaType="java.lang.Integer" />
      <arg column="isdao" jdbcType="INTEGER" javaType="java.lang.Integer" />
      <arg column="daoTime" jdbcType="TIMESTAMP" javaType="java.sql.Timestamp" />
      <arg column="time" jdbcType="TIMESTAMP" javaType="java.sql.Timestamp" />
      <arg column="checkinNumber" jdbcType="INTEGER" javaType="java.lang.Integer" />
      <arg column="status" jdbcType="INTEGER" javaType="java.lang.Integer" />

    </constructor>
  </resultMap>

<!--  //新增订单-->
  <insert id="insertAll" parameterType="com.gx.po.OrderPo" useGeneratedKeys="true"  keyProperty="id">
INSERT INTO `publicorder` (`orderNumber`,`hotelm`, `roomNumber`, `paltform`,`pname`, `sex`,`phone`,`checkintime`,
  `checkouttime`,`checkinNumber`,`money`,`currency`,`isdao`,`daotime`,`time`,`status`)
VALUES  (#{orderNumber,jdbcType=VARCHAR},#{hotelm,jdbcType=VARCHAR}, #{roomNumber,jdbcType=VARCHAR},
    #{paltform,jdbcType=VARCHAR},#{pname,jdbcType=VARCHAR},#{sex,jdbcType=VARCHAR},#{phone,jdbcType=VARCHAR},
    #{checkintime,jdbcType=TIMESTAMP},#{checkouttime,jdbcType=TIMESTAMP},#{checkinNumber,jdbcType=INTEGER},
    #{money,jdbcType=DOUBLE},
   #{currency,jdbcType=INTEGER},#{isdao,jdbcType=INTEGER},#{daotime,jdbcType=TIMESTAMP},
   #{time,jdbcType=TIMESTAMP},#{status,jdbcType=INTEGER} )
  </insert>
<!--已确认-->
  <select id="list" resultType="com.gx.po.PublicOrderPo">
    SELECT *
    FROM `publicorder`
    where 1=1
    <if test="orderNumber!=null and orderNumber!=''">
      and  orderNumber like CONCAT('%',#{orderNumber,jdbcType=VARCHAR},'%')
    </if>
    <if test="pname!=null and pname!=''">
      and  pname like CONCAT('%',#{pname,jdbcType=VARCHAR},'%')
    </if>

    ORDER BY `checkinTime`
    LIMIT #{start},#{pageSize}
  </select>

  <select id="count" resultType="java.lang.Integer">
    SELECT COUNT(*)
    FROM `publicorder`
    where 1=1
    <if test="orderNumber!=null and orderNumber!=''">
      and  orderNumber like CONCAT('%',#{orderNumber,jdbcType=VARCHAR},'%')
    </if>
    <if test="pname!=null and pname!=''">
      and  pname like CONCAT('%',#{pname,jdbcType=VARCHAR},'%')
    </if>

  </select>
  <update id="updateDao">
    UPDATE  `publicorder` SET `isdao`=2,daoTime=#{timestamp,jdbcType=TIMESTAMP} WHERE id=#{id,jdbcType=INTEGER}

  </update>

  <update id="updateStatus">
    UPDATE  `publicorder` SET `status`=#{status,jdbcType=INTEGER} WHERE id=#{id,jdbcType=INTEGER}
  </update>
  <select id="YZ" resultType="java.lang.Integer">
     SELECT COUNT(*)
    FROM `publicorder` where orderNumber=#{orderNumber,jdbcType=VARCHAR}
  </select>

  <select id="selectInByTime" resultType="com.gx.po.PublicOrderPo">
    SELECT * FROM `publicorder` WHERE 1=1
    <if test="orderNumber!=null and orderNumber!=''">
      and  orderNumber like CONCAT('%',#{orderNumber,jdbcType=VARCHAR},'%')
    </if>
    <if test="pname!=null and pname!=''">
      and  pname like CONCAT('%',#{pname,jdbcType=VARCHAR},'%')
    </if>
   AND `status`=4
    AND DATE_FORMAT(`checkintime`, '%Y-%m-%d') =#{time,jdbcType=VARCHAR}
     ORDER BY `checkintime`
    LIMIT #{start},#{pageSize}
  </select>

  <select id="countInByTime" resultType="java.lang.Integer">
    SELECT COUNT(*) FROM `publicorder` WHERE 1=1
    <if test="orderNumber!=null and orderNumber!=''">
      and  orderNumber like CONCAT('%',#{orderNumber,jdbcType=VARCHAR},'%')
    </if>
    <if test="pname!=null and pname!=''">
      and  pname like CONCAT('%',#{pname,jdbcType=VARCHAR},'%')
    </if>
    AND `status`=4
    AND DATE_FORMAT(`checkintime`, '%Y-%m-%d') =#{time,jdbcType=VARCHAR}
  </select>


  <select id="selectmyfinance" resultType="com.gx.po.PublicOrderPo">
    SELECT * FROM `publicorder` WHERE 1=1
    <if test="orderNumber!=null and orderNumber!=''">
      and  orderNumber like CONCAT('%',#{orderNumber,jdbcType=VARCHAR},'%')
    </if>
    <if test="pname!=null and pname!=''">
      and  pname like CONCAT('%',#{pname,jdbcType=VARCHAR},'%')
    </if>
    <if test="time!=null and time!=''">
      AND DATE_FORMAT(`checkintime`, '%Y-%m-%d') =#{time,jdbcType=VARCHAR}
    </if>
    ORDER BY `checkintime`
    LIMIT #{start},#{pageSize}
  </select>

  <select id="countmyfinance" resultType="java.lang.Integer">
    SELECT COUNT(*) FROM `publicorder` WHERE 1=1
    <if test="orderNumber!=null and orderNumber!=''">
      and  orderNumber like CONCAT('%',#{orderNumber,jdbcType=VARCHAR},'%')
    </if>
    <if test="pname!=null and pname!=''">
      and  pname like CONCAT('%',#{pname,jdbcType=VARCHAR},'%')
    </if>
    <if test="time!=null and time!=''">
    AND DATE_FORMAT(`checkintime`, '%Y-%m-%d') =#{time,jdbcType=VARCHAR}
  </if>
  </select>

  <select id="selectOrder" resultType="com.gx.po.PublicOrderPo">
    SELECT * FROM `publicorder` WHERE 1=1
    <if test="orderNumber!=null and orderNumber!=''">
      and  orderNumber like CONCAT('%',#{orderNumber,jdbcType=VARCHAR},'%')
    </if>
    <if test="pname!=null and pname!=''">
      and  pname like CONCAT('%',#{pname,jdbcType=VARCHAR},'%')
    </if>
    <if test="isdao!=null and isdao!=0">
      AND isdao=#{isdao,jdbcType=VARCHAR}
    </if>
    ORDER BY `checkintime`
    LIMIT #{start},#{pageSize}
  </select>

  <select id="countOrder" resultType="java.lang.Integer">
    SELECT COUNT(*) FROM `publicorder` WHERE 1=1
    <if test="orderNumber!=null and orderNumber!=''">
      and  orderNumber like CONCAT('%',#{orderNumber,jdbcType=VARCHAR},'%')
    </if>
    <if test="pname!=null and pname!=''">
      and  pname like CONCAT('%',#{pname,jdbcType=VARCHAR},'%')
    </if>
    <if test="isdao!=0 and isdao!=null">
      AND isdao=#{isdao,jdbcType=VARCHAR}
    </if>
  </select>
</mapper>