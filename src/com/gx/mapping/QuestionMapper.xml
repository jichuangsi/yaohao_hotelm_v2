<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gx.dao.QuestionDao" >
  <resultMap id="BaseResultMap" type="com.gx.po.QuestionPo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Oct 16 19:18:30 CST 2016.
    -->
    <constructor >
      <idArg column="id" jdbcType="INTEGER" javaType="java.lang.Integer" />
        <idArg column="hotelm" jdbcType="INTEGER" javaType="java.lang.Integer" />
      <arg column="title" jdbcType="VARCHAR" javaType="java.lang.String" />
      <arg column="createTime" jdbcType="BIGINT" javaType="java.lang.Long" />
    </constructor>
  </resultMap>

<!--   查看客房等级 -->
  <select id="listall" resultType="com.gx.po.QuestionPo">
    SELECT * FROM question q  INNER JOIN `supplier` s ON q.`hotelm`=s.id
      WHERE 1=1
    <if test="title==null and title==''">
    title like CONCAT('%',#{title,jdbcType=VARCHAR},'%')
    </if>

  </select>
    <!--   查看客房等级 -->
    <select id="list" resultType="com.gx.po.QuestionPo">
        SELECT * FROM question  q  INNER JOIN `supplier` s ON q.`hotelm`=s.id
        WHERE 1=1
        <if test="title==null and title==''">
            title like CONCAT('%',#{title,jdbcType=VARCHAR},'%')
        </if>
      LIMIT #{start},#{pageSize}
    </select>

    <select id="count" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM question WHERE 1=1
        <if test="title==null and title==''">
            title like CONCAT('%',#{title,jdbcType=VARCHAR},'%')
        </if>
    </select>
  <!--   新增 -->
  <insert id="insertAll" parameterType="com.gx.po.QuestionPo"  useGeneratedKeys="true"  keyProperty="id">
    INSERT INTO `question` (`hotelm`, `title`, `createTime`)
    VALUES
  (#{hotelm,jdbcType=INTEGER},#{title,jdbcType=VARCHAR},#{createTime,jdbcType=BIGINT}) ;
  </insert>
  <!--    修改 -->
  <update id="updateById" parameterType="com.gx.po.QuestionPo">
      UPDATE question SET title=#{title,jdbcType=VARCHAR}
                   WHERE id = #{id,jdbcType=INTEGER}
   </update>

    <select id="questionById" resultType="com.gx.po.QuestionPo">
           SELECT * FROM question WHERE id = #{id,jdbcType=INTEGER}
    </select>

    <delete id="deleteById">
        DELETE FROM `question` WHERE id=#{id,jdbcType=INTEGER}
    </delete>

    <insert id="inserImg" parameterType="com.gx.po.QuestionImgPo">
        INSERT INTO `questionimg` (`qid`, `qimg`)
        VALUES (#{qid,jdbcType=INTEGER},#{qimg,jdbcType=BLOB}) ;
    </insert>
    <insert id="inserVideo" parameterType="com.gx.po.QuestionVideoPo">
        INSERT INTO `questionvideo` (`qid`, `upload`)
        VALUES (#{qid,jdbcType=INTEGER},#{upload,jdbcType=VARCHAR}) ;
    </insert>
    <select id="imgByQid" resultType="com.gx.po.QuestionImgPo">
      SELECT * FROM questionimg WHERE `qid`=#{qid,jdbcType=INTEGER}
    </select>
    <delete id="delImg">
    DELETE  FROM `questionimg`
        WHERE `id` = #{id,jdbcType=INTEGER} ;
    </delete>
    <update id="updateImg" parameterType="com.gx.po.QuestionImgPo">
        UPDATE `questionimg`
        SET
          `qid` =#{qid,jdbcType=INTEGER},
          `qimg` = #{qimg,jdbcType=BLOB}
        WHERE `id` = #{id,jdbcType=INTEGER};
    </update>
    <select id="videoByQid" resultType="com.gx.po.QuestionVideoPo">
      SELECT * FROM questionvideo WHERE `qid`=#{qid,jdbcType=INTEGER}
    </select>

    <delete id="delVideo">
        DELETE  FROM `questionvideo`
        WHERE `id` = #{id,jdbcType=INTEGER} ;
    </delete>

    <update id="updateVideo" parameterType="com.gx.po.QuestionVideoPo">
        UPDATE `questionvideo`
        SET
          `qid` =#{qid,jdbcType=INTEGER},
          upload=#{upload,jdbcType=VARCHAR}
        WHERE `id` = #{id,jdbcType=INTEGER};
    </update>

    <delete id="delImgQid">
         DELETE  FROM `questionimg`
        WHERE `qid` = #{qid,jdbcType=INTEGER} ;
    </delete>
    <delete id="delVideoQid">
         DELETE  FROM `questionvideo`
        WHERE `qid` = #{qid,jdbcType=INTEGER} ;
    </delete>

    <select id="listoage" resultType="com.gx.vo.QuestionAnserVo">
        SELECT *,q.`id` AS qid,q.`hotelm` ashotelm,q.`title` AS title,q.`createTime` AS `time`,s.`supplierName` AS hotelmName
         FROM question  q  INNER JOIN `supplier` s ON q.`hotelm`=s.id
        WHERE 1=1
        <if test="name==null and name==''">
            title like CONCAT('%',#{title,jdbcType=VARCHAR},'%')
        </if>
        ORDER BY q.`id`
        LIMIT #{start},#{pageSize}
    </select>

    <select id="listanser" resultType="com.gx.po.AnserPo">
        SELECT * FROM `anser` WHERE `questionId`= #{qid,jdbcType=INTEGER}
        LIMIT #{start},#{pageSize}
    </select>
    <select id="listansercount" resultType="java.lang.Integer">
      SELECT COUNT(*) FROM `anser` WHERE `questionId`= #{qid,jdbcType=INTEGER}
    </select>

    <select id="selectImgByid" resultType="com.gx.po.QuestionImgPo">
          SELECT * FROM `questionimg` WHERE `id`= #{id,jdbcType=INTEGER}
    </select>
    <select id="selectVideoByid" resultType="com.gx.po.QuestionVideoPo">
  SELECT * FROM `questionvideo` WHERE `id`= #{id,jdbcType=INTEGER}
    </select>
</mapper>